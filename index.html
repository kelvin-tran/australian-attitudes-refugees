<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Australian attitudes towards refugees by federal electorate</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    
      ga('create', 'UA-64459548-1', 'auto');
      ga('send', 'pageview');
    </script>
    <style>

		.background {
			fill: none;
			pointer-events: all;
		}

    .path {
      fill: none;
      stroke-width: 1.5;
      stroke-dasharray: 3,6;
      stroke: white;
    }
    .graticule {
      fill: none;
      stroke: #777;
    }
    .land-boundary {
      fill: #ccc;
      fill-opacity: 0.8;
      stroke: gray;
      stroke-width: 1;
    }
    .div-boundary {
      fill: none;
      fill-opacity: 0.8;
      stroke: gray;
      stroke-width: 1;
    }

		.divisions {
		  fill: none;
		}
		
		.states {
		  fill: none;
		  stroke: #fff;
		  stroke-linejoin: round;
		}

		.q0-9 { fill:rgb(247,251,255); }
		.q1-9 { fill:rgb(222,235,247); }
		.q2-9 { fill:rgb(198,219,239); }
		.q3-9 { fill:rgb(158,202,225); }
		.q4-9 { fill:rgb(107,174,214); }
		.q5-9 { fill:rgb(66,146,198); }
		.q6-9 { fill:rgb(33,113,181); }
		.q7-9 { fill:rgb(8,81,156); }
		.q8-9 { fill:rgb(8,48,107); }
		
		#legend {
			padding: 1.5em 0 0 1.5em;
		}
		
		li.key {
			border-top-width: 15px;
			border-top-style: solid;
			font-size: .75em;
			width: 5%;
			padding-left: 0;
			padding-right: 0;
		}
		
		.list-inline {
			padding-left:0;
			list-style:none;
		}
		
		.list-inline > li {
			display:inline-block;
			padding-right:5px;
			padding-left:5px;
		}
		
		.place,
		.place-label {
			fill: #444;
		}
		
		text {
		  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
		  font-size: 10px;
		  pointer-events: none;
		}
    
    </style>
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Kelvin Tran</h1>
        <p>
        <img src="https://raw.githubusercontent.com/kelvin-tran/kelvin-tran.github.io/master/static/profile.jpg" style="width:140px;height:140px;border-radius: 10px;">
        </p>
        <p>I am a lawyer, but I do <a href="http://kelvin-tran.github.io/">other things</a></p>
        <p class="view"><a href="http://github.com/kelvin-tran">GitHub</a> | <a href="http://twitter.com/_kelvintran">Twitter</a> | <a href="https://au.linkedin.com/in/kelvintran">LinkedIn</a></p>
        <div>
					<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
          <!-- Kelvin Tran GitHub pages index -->
          <ins class="adsbygoogle"
               style="display:block"
               data-ad-client="ca-pub-8039812474190322"
               data-ad-slot="3954668498"
               data-ad-format="auto"></ins>
          <script>
          	(adsbygoogle = window.adsbygoogle || []).push({});
        	</script>
        </div>
      </header>
      <section>
      	<h1>Australian attitudes towards refugees by federal electorate</h1>
				<p><em>View the <a href="http://github.com/kelvin-tran/australian-attitudes-refugees/">source of this content</a>.  Federal electoral boundary GIS data from the <a href"http://www.aec.gov.au/Electorates/gis/gis_datadownload.htm">AEC</a>.</em></p>
				<p><em>This page works best on Chrome and will not display properly with Internet Explorer.</em></p>
				<p>Overly strict immigration laws is an issue that gets me down if I think about it for too long.  Who are these people that are against immigration?   Where do they live?</p>
				<p>Below is a visualisation of responses to the statement 'Turn back boats carrying asylum seekers' contained in ANU's <a href="http://aes.anu.edu.au/">Australian Election Study</a> conducted in 2013. I've isolated the responses to those by voters who strongly agreed with the statement on the basis that it was only those voters who had sufficiently strong feelings against immigration that it might have dominated their vote. (One of the more useful concepts I learned during my masters was how voting systems that account for <a href="https://en.wikipedia.org/wiki/Intensity_of_preference">intensity of preference</a>, rather than merely ordinal preferences, can be superior).</p>
        <div id="map"><div id="legend"><small>Proportion of responses strongly agreeing with 'Turn back boats carrying asylum seekers'</small></div></div>
        <em>A map of people wanting to 'turn back boats'.  Click to center and scroll (slowly) to zoom.</em>
        <br><br>
        <p>Responses from Lingiari (NT) and Flynn (Queensland) top the list at around 54 per cent, while Melbourne (Victoria) and Wills (covering the inner north-west of Melbourne) are at the other end with only about 4 percent strongly agreeing with the statement.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/kelvin-tran">kelvin-tran</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/queue-async/1.0.7/queue.min.js"></script>
    <script src="http://d3js.org/d3.geo.projection.v0.min.js"></script>
    <script src="http://d3js.org/topojson.v1.min.js"></script>
    <script>
      var width = 500,
          height = 500;
          
			var formats = {
					percent: d3.format('%')
			};

			var rateById = d3.map()
					response_values = [];
			
			var quantize = d3.scale.quantize()
				.range(d3.range(9).map(function(i) { return "q" + i + "-9"; }));
      
      var graticule = d3.geo.graticule()
          .step([10, 10]);
      
      var projection = d3.geo.satellite()
          .scale(785)
          .distance(1.5)
          .rotate([-146, 31.679999999999996, 20])
          .center([5,1])
          .tilt(30)
          .clipAngle(45)
          ;
      
      var path = d3.geo.path()
          .projection(projection)
          .pointRadius(1);
          
			var zoom = d3.behavior.zoom()
			    .translate(projection.translate())
			    .scale(projection.scale())
			    .scaleExtent([height, 14 * height])
			    .on("zoom", zoomed);
      
      var svg = d3.select("#map").append("svg")
          .attr("width", width)
          .attr("height", height);
          
			var g = svg.append("g")
					.call(zoom);

			g.append("rect")
					.attr("class", "background")
					.attr("width", width)
					.attr("height", height);
      
      g.append("path")
          .datum(graticule)
          .attr("class", "graticule")
          .attr("d", path);
          
			var legend = d3.select('#legend')
			  .append('ul')
			    .attr('class', 'list-inline');
      
			queue()
					.defer(d3.json, "https://raw.githubusercontent.com/kelvin-tran/australian-attitudes-refugees/master/t_aus_bound.json")
					.defer(d3.csv, "https://raw.githubusercontent.com/kelvin-tran/australian-attitudes-refugees/master/refugees.csv", function(d) { 
						rateById.set(d.id, +d.strongly_agree); 
						response_values.push(+d.strongly_agree);
					})
					.defer(d3.json, "https://raw.githubusercontent.com/kelvin-tran/australian-attitudes-refugees/master/places.json")
					.await(ready);
    	
			function ready(error, aus, responses, name_data) {
				if (error) throw error;
				
				quantize.domain([
					d3.min(response_values),
					d3.max(response_values)
				]);
			
				g.append("g")
						.attr("class", "divisions")
					.selectAll("path")
						.data(topojson.feature(aus, aus.objects.aus_bound).features)
					.enter().append("path")
						.attr("class", function(d) {
							return quantize(rateById.get(d.id)); 
						})
						.attr("d", path)
						.on("click", clicked);
						
				g.append("path")
					.datum(topojson.feature(name_data, name_data.objects.places))
						.attr("d", path)
						.attr("class", "place");
				
				g.selectAll(".place-label")
					.data(topojson.feature(name_data, name_data.objects.places).features)
					.enter().append("text")
						.attr("class", "place-label")
						.attr("transform", function(d) { return "translate(" + projection(d.geometry.coordinates) + ")"; })
						.attr("dy", ".35em")
						.text(function(d) { return d.properties.name; });
						
				var colors = d3.scale.quantize()
					.domain([
						d3.min(response_values),
						d3.max(response_values)
					])
					.range([
							"rgb(247,251,255)",
							"rgb(222,235,247)",
							"rgb(198,219,239)",
							"rgb(158,202,225)",
							"rgb(107,174,214)",
							"rgb(66,146,198)",
							"rgb(33,113,181)",
							"rgb(8,81,156)",
							"rgb(8,48,107)"
					]);
				
				var keys = legend.selectAll('li.key')
						.data(colors.range());
				
				keys.enter().append('li')
						.attr('class', 'key')
						.style('border-top-color', String)
						.text(function(d) {
						  var r = colors.invertExtent(d);
						  return formats.percent(r[0]/100);
						});
			}

			function clicked(d) {
				var centroid = path.centroid(d),
						translate = projection.translate();
			
				projection.translate([
					translate[0] - centroid[0] + width / 2,
					translate[1] - centroid[1] + height / 2
			  ]);
			
				zoom.translate(projection.translate());
			
				g.selectAll("path").transition()
						.duration(700)
						.attr("d", path);
				
				g.selectAll(".place-label").transition()
						.duration(700)
						.attr("transform", function(d) { return "translate(" + projection.translate() + ")";
			}
			
			function zoomed() {
				projection.translate(d3.event.translate).scale(d3.event.scale);
				g.selectAll("path").attr("d", path);
				g.selectAll(".place-label").attr("transform", function(d) { return "translate(" + projection(d.geometry.coordinates) + ")"; });
			}
			
      d3.select(self.frameElement).style("height", height + "px");
    </script>
  </body>




